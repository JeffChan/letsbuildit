<!DOCTYPE html>
<html lang="en">
<head>
	<title>Ballz</title>
	<link rel="stylesheet" type="text/css" href="c/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="c/slider.css" />
	<link rel="stylesheet" type="text/css" href="c/style.css" />

	<script type="text/javascript" src="j/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="j/bootstrap.min.js"></script>
	<script type="text/javascript" src="j/bootstrap-slider.js"></script>

	<script type="text/javascript" src="j/underscore-min.js"></script>
	<script type="text/javascript" src="j/three.min.js"></script>
	<script type="text/javascript" src="j/csg.js"></script>
	<script type="text/javascript" src="j/ThreeCSG.js"></script>
	<script type="text/javascript" src="j/TrackballControls.js"></script>
	<script type="text/javascript" src="j/GeometryExporter.js"></script>
	<script type="text/javascript" src="j/FileSaver.min.js"></script>

	<script type="text/javascript" src="j/app.js"></script>

	<script type="text/javascript">

	$(function() {

		$('#help').modal();

		window.app = new App({
			htmlContainer: '#sandbox',
			width: 460,
			height: 345
		});

		window.demo = new App({
			htmlContainer: '#exhibit',
			width: 300,
			height: 225,
			locked: true
		});
		$('#export').on('click', function(e) {
			e.preventDefault();
			app.export(true);
		});
		$('#file').on('change', function(e) {
			var file = e.target.files[0];
			var reader = new FileReader();
			reader.onload = (function(theFile) {
				return function(e) {
					demo.redrawPiece(demo.import(e.target.result));
				}
			})(file);
			reader.readAsText(file);
		});

		$('a.tool').on('click', function(e) {
			e.preventDefault();
			var $tool = $(e.target);
			var id = $tool.attr('id');
			$('#currentTool').text($tool.text());
			app.setMode(id);

			$('body').removeClass('selected-mill selected-drill selected-saw').addClass('selected-'+id);

			$('a.tool').each(function(i, el) {
				$(el).removeClass('btn-info');
			});
			$tool.addClass('btn-info');
		});

		var descriptions = {
			mill: 'mill is the bomb',
			saw: 'saw is the bomb',
			drill: 'drill is the bomb'
		};
		$('a.tool').each(function(i, el) {
			var $tool = $(el);
			var i = $tool.attr('id');
			$tool.popover({
				trigger: 'hover focus',
				container: $tool[0],
				title: $tool.text(),
				content: descriptions[i]
			});
		});

		$('.disabled-tool').popover({
			trigger: 'hover focus',
			title: 'Not Available',
			content: 'This tool is not available for noobs!'
		});

		$('#gridToggle').on('click', function(e) {
			e.preventDefault();
			var el = $(this);
			var state = el.data('state');
			switch (state) {
				case 'show' :
					app.showGrid(true);
					demo.showGrid(true);
					el.data('state', 'hide');
					el.find('span').text('Hide Grid');
					break;
				case 'hide' :
					app.showGrid(false);
					demo.showGrid(false);
					el.data('state', 'show');
					el.find('span').text('Show Grid');
					break;
			}
		});

		$("#radius").slider({
			value: 5,
			min: 2,
			max: 12,
			step: 2
		}).on('slideStop', function(e) {
			app.radius = e.value;
		});

		$("#depth").slider({
			value: 10,
			min: 2,
			max: 100,
			step: 4
		}).on('slideStop', function(e) {
			app.depth = e.value;
		});

		$('#cutInverse').on('change', function(e) {
			if (this.checked) {
				app.cutInverse = true;
			} else {
				app.cutInverse = false;
			}
		});

		$('.change-view').on('click', function(e) {
			var $el = $(this);
			var view = $el.attr('id');
			app.setView(view);
			demo.setView(view);
		});
	});

	</script>
</head>

<body>

<div id="about" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
		<h2>About</h2>
	</div>
	<div class="modal-body">
		<p>TODO</p>
	</div>
</div>

<div id="help" class="modal hide fade" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
		<h2>Instructions</h2>
	</div>
	<div class="modal-body">
		<p>TODO</p>
	</div>
	<div class="modal-footer">
		<button class="btn btn-success" data-dismiss="modal" aria-hidden="true">I'm Ready to Play!</button>
	</div>
</div>

<div class="wrapper">
	<div class="navbar navbar-inverse"><div class="navbar-inner">
		<span class="brand">Let's Build It</span>
		<div class="nav-collapse">
			<ul class="nav">

			</ul>
			<ul class="nav pull-right">
				<!-- <li class="dropdown">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown">Options <b class="caret"></b></a>
					<ul class="dropdown-menu">
						<li><a href="#" id="export">Download</a></li>
					</ul>
				</li> -->
				<li><a href="#" data-toggle="modal" data-target="#help">Instructions</a></li>
				<li><a href="#" data-toggle="modal" data-target="#about">About</a></li>
			</ul>
		</div>
	</div></div>

	<div class="belly">

	<div class="row">
		<div class="tools span2">
			<h3>Tools</h3>
			<a id="drill" class="tool btn btn-large">Drill Press</a>
			<a id="mill" class="tool btn btn-large">Mill</a>
			<a id="saw" class="tool btn btn-large">Band Saw</a>
			<span id="sander" class="disabled-tool tool btn btn-large btn-inverse">Belt Sander</span>
			<span id="lathe" class="disabled-tool tool btn btn-large btn-inverse">Lathe</span>
		</div>

		<div class="span10">
			<div class="row">
				<div class="span4">
					<h3>Time Left: 6 minutes</h3>
				</div>
				<div class="span4">
					<br>
					<div class="progress progress-danger progress-striped active" style="height: 29px;">
						<div class="bar" style="width: 60%;"></div>
					</div>
				</div>
				<div class="span2">
					<br>
					<a class="btn btn-success" href="#" id="export">
						<i class="icon-ok icon-white"></i>&nbsp;
						I'm Done!
					</a>
				</div>
			</div>

			<div class="row">
				<div id="sandbox" class="span6">
					<h4>Workbench</h4>
					<!--canvas-->
					<div class="well">
						<label class="radius">Radius&nbsp; <input id="radius" type="text" class="span3" /></label>
						<label class="depth">Depth&nbsp; <input id="depth" type="text" class="span3" /></label>
						<label class="cutInverse">Cut Inverse&nbsp; <input type="checkbox" id="cutInverse" value="cutInverse" /></label>
					</div>
				</div>

				<div id="exhibit" class="span4">
					<h4>Sample</h4>
					<!--canvas-->
					<br><br>
					<a class="btn btn-info" href="#" id="export">
						<i class="icon-download icon-white"></i>&nbsp;
						Download
					</a>
					<a class="btn btn-info" href="#" id="gridToggle" data-state="hide">
						<i class="icon-th icon-white"></i>&nbsp;
						<span>Hide Grid</span>
					</a>
					<br><br>
					<div class="btn-group">
						<button class="btn change-view" id="isometric">Isometric</button>
						<button class="btn change-view" id="top">Top</button>
						<button class="btn change-view" id="right">Right</button>
						<button class="btn change-view" id="front">Front</button>
					</div>
				</div>
			</div>
		</div>

	</div>

	<!-- <strong>Import:</strong> <input type="file" id="file" /> -->
	</div>

</div>

</body>

</html>